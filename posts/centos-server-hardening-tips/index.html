<!DOCTYPE html><html lang="en" data-mode="dark" ><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" /><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="CentOS Server Hardening Tips" /><meta name="author" content="Steven Marks" /><meta property="og:locale" content="en" /><meta name="description" content="This article provides various hardening tips for your Linux server." /><meta property="og:description" content="This article provides various hardening tips for your Linux server." /><link rel="canonical" href="https://totaldebug.uk/posts/centos-server-hardening-tips/" /><meta property="og:url" content="https://totaldebug.uk/posts/centos-server-hardening-tips/" /><meta property="og:site_name" content="TotalDebug" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2014-05-29T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="CentOS Server Hardening Tips" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Steven Marks"},"dateModified":"2022-10-27T16:24:01+01:00","datePublished":"2014-05-29T00:00:00+01:00","description":"This article provides various hardening tips for your Linux server.","headline":"CentOS Server Hardening Tips","mainEntityOfPage":{"@type":"WebPage","@id":"https://totaldebug.uk/posts/centos-server-hardening-tips/"},"url":"https://totaldebug.uk/posts/centos-server-hardening-tips/"}</script><title>CentOS Server Hardening Tips | TotalDebug</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="TotalDebug"><meta name="application-name" content="TotalDebug"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" /><link rel="dns-prefetch" href="https://fonts.googleapis.com" /><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin /><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin /><link rel="preconnect" href="https://fonts.googleapis.com" /><link rel="dns-prefetch" href="https://fonts.googleapis.com" /><link rel="preconnect" href="https://cdn.jsdelivr.net" /><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" /><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap" /><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials" /><link rel="dns-prefetch" href="https://www.google-analytics.com" /><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous" /><link rel="dns-prefetch" href="https://www.googletagmanager.com" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.3/font/bootstrap-icons.css" /><link rel="stylesheet" href="/assets/css/style.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css" /> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/logo.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">TotalDebug</a></div><div class="site-subtitle font-italic">Technology. Inside Out</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="bi bi-house ml-xl-3 mr-xl-3 unloaded"></i> <span></span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="bi bi-list-nested ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="bi bi-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="bi bi-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="bi bi-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/works/" class="nav-link"> <i class="bi bi-kanban ml-xl-3 mr-xl-3 unloaded"></i> <span>WORKS</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a class="btn" href="https://github.com/marksie1988" aria-label="github" target="_blank" rel="noopener"> <i class="bi bi-github"></i> </a> <a class="btn" href="https://www.linkedin.com/in/marksie1988" aria-label="linkedin" target="_blank" rel="noopener"> <i class="bi bi-linkedin"></i> </a> <a class="btn" href="/feed.xml" aria-label="rss" > <i class="bi bi-rss"></i> </a> <a class="btn" href="https://discord.gg/6fmekudc8Q" aria-label="discord" > <i class="bi bi-discord"></i> </a> <a class="btn" href="https://github.com/marksie1988" aria-label="github" > <i class="bi bi-github"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>CentOS Server Hardening Tips</span> </span> <i id="sidebar-trigger" class="bi bi-list"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="bi bi-search"></i> <span id="search-wrapper" class="align-items-center"> <i class="bi bi-search"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>CentOS Server Hardening Tips</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1401318000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 29, 2014 </em> </span> <span> Updated <em class="" data-ts="1666884241" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Oct 27, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/marksie1988">Steven Marks</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1316 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>This article provides various hardening tips for your Linux server.</p><h4 id="1-minimise-packages-to-minimise-vulnerability"><span class="mr-2">1. Minimise Packages to Minimise Vulnerability</span><a href="#1-minimise-packages-to-minimise-vulnerability" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>Do you really want all sorts of services installed?. It’s recommended to avoid installing packages that are not required to avoid vulnerabilities. This may minimise risks that compromise other services on your server. Find and remove or disable unwanted services from the server to minimize vulnerability. Use the <strong>chkconfig</strong> command to find out services which are running on <strong>runlevel 3</strong>.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/sbin/chkconfig <span class="nt">--list</span> |grep <span class="s1">'3:on'</span>
</pre></table></code></div></div><p>Once you’ve found any unwanted services that are running, disable them using the following command:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>chkconfig serviceName off
</pre></table></code></div></div><p>Use the RPM package managers such as <strong>yum</strong> or <strong>apt-get</strong> tools to list all installed packages on a system and remove them using the following command:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>yum <span class="nt">-y</span> remove package-name
</pre></table></code></div></div><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt-get remove package-name
</pre></table></code></div></div><h4 id="2-check-listening-network-ports"><span class="mr-2">2. Check Listening Network Ports</span><a href="#2-check-listening-network-ports" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>With the help of the <strong>netstat</strong> networking command you can view all open ports and associated programs. As I said above use the <strong>chkconfig</strong> command to disable all unwanted network services on the system.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>netstat <span class="nt">-tulpn</span>
</pre></table></code></div></div><h4 id="3-use-secure-shellssh"><span class="mr-2">3. Use Secure Shell(SSH)</span><a href="#3-use-secure-shellssh" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p><strong>Telnet</strong> and <strong>rlogin</strong> protocols use plain text, a non encrypted format which is prone to security breaches. SSH is a secure protocol that uses encryption technologies during communication.</p><p>Never login directly as <strong>root</strong> unless necessary. Use <strong>sudo</strong> to execute commands. sudo users are specified in the <code class="language-plaintext highlighter-rouge">/etc/sudoers</code> file which can be edited with the <strong>visudo</strong> utility which opens in the VI editor.</p><p>It’s also recommended to change default SSH (22) port number with a different unassigned port number. Open the main SSH configuration file and change the following parameters to restrict users to access. (<code class="language-plaintext highlighter-rouge">vi /etc/ssh/sshd_config</code>)</p><h5 id="disable-root-login"><span class="mr-2">Disable root Login</span><a href="#disable-root-login" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><p>This will disable users from logging in over SSH with the Root account, Obviously if you don’t have console access don’t change this setting.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>PermitRootLogin n
</pre></table></code></div></div><h5 id="only-allow-specific-users"><span class="mr-2">Only Allow Specific Users</span><a href="#only-allow-specific-users" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><p>Change this to only allow users that you want to be using SSH Access (one line per user)</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>AllowUsers username
AllowUsers username
</pre></table></code></div></div><h5 id="use-ssh-protocol-2-version"><span class="mr-2">Use SSH Protocol 2 Version</span><a href="#use-ssh-protocol-2-version" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><p>This should be used in all cases!</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Protocol 2
</pre></table></code></div></div><h4 id="4-keep-your-system-updated"><span class="mr-2">4. Keep Your System updated</span><a href="#4-keep-your-system-updated" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>Always keep your system updated with latest releases, patches, security fixes and kernel updates when available.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>yum updates
yum check-update
</pre></table></code></div></div><h4 id="5-lockdown-cronjobs"><span class="mr-2">5. Lockdown Cronjobs</span><a href="#5-lockdown-cronjobs" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p><strong>Cron</strong> has a built in feature, where it allows you to specify who can and can not run cron jobs. This is controlled by the use of the following files called <code class="language-plaintext highlighter-rouge">/etc/cron.allow</code> and <code class="language-plaintext highlighter-rouge">/etc/cron.deny</code>. To stop a user using cron, simply add their user names to <code class="language-plaintext highlighter-rouge">cron.deny</code> and to allow a user to run cron add them to <code class="language-plaintext highlighter-rouge">cron.allow</code>. If you would like to disable all users from using cron, add the <strong>ALL</strong> line to <code class="language-plaintext highlighter-rouge">cron.deny</code> file.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">echo </span>username <span class="o">&gt;&gt;</span>/etc/cron.allow
<span class="nb">echo </span>ALL <span class="o">&gt;&gt;</span>/etc/cron.deny
</pre></table></code></div></div><h4 id="6-remove-kdegnome-desktops"><span class="mr-2">6. Remove KDE/GNOME Desktops</span><a href="#6-remove-kdegnome-desktops" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>There is no need to run X Window desktops like KDE or GNOME on your LAMP server. You can remove or disable them to increase security and performance. To disable simple open the file <code class="language-plaintext highlighter-rouge">/etc/inittab</code> and set the run level to 3. If you wish to remove it completely from the system use the below command.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>yum groupremove <span class="s2">"X Window System"</span>
</pre></table></code></div></div><h4 id="7-turn-off-ipv6"><span class="mr-2">7. Turn Off IPv6</span><a href="#7-turn-off-ipv6" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>If you’re not using a IPv6 protocol, then you should disable it. Most of the applications or policies don’t required IPv6 protocol and currently it isn’t required on the server. Go to the network configuration file and add followings lines to disable it.(<code class="language-plaintext highlighter-rouge">vi /etc/sysconfig/network</code>)</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">NETWORKING_IPV6</span><span class="o">=</span>no
<span class="nv">IPV6INIT</span><span class="o">=</span>no
</pre></table></code></div></div><h4 id="8-restrict-users-from-using-old-passwords"><span class="mr-2">8. Restrict Users from using Old Passwords</span><a href="#8-restrict-users-from-using-old-passwords" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>This is very useful if you want to stop users using the same old passwords. The old password file is located at <code class="language-plaintext highlighter-rouge">/etc/security/opasswd</code>. This can be achieved by using the PAM module. <code class="language-plaintext highlighter-rouge">vi /etc/pam.d/system-auth</code></p><p>Add the following line to the <strong>auth</strong> section</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>auth        sufficient    pam_unix.so likeauth nullok
</pre></table></code></div></div><p>Add the following line to <strong>password</strong> section to disallow a user from re-using the last 5 password.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>password   sufficient    pam_unix.so nullok use_authtok md5 shadow <span class="nv">remember</span><span class="o">=</span>5
</pre></table></code></div></div><p>Only the last <strong>5</strong> passwords are remembered by the server, if you try to use any of the last <strong>5</strong> old passwords you will receive an error.</p><h4 id="9-enforce-stronger-passwords"><span class="mr-2">9. Enforce Stronger Passwords</span><a href="#9-enforce-stronger-passwords" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>A number of users use soft or weak passwords and their password might be hacked with a dictionary based or brute-force attack. The <code class="language-plaintext highlighter-rouge">pam_cracklib</code> module is available in the PAM (Pluggable Authentication Modules) module stack which will force a user to set a strong passwords. Add the following to this file (<code class="language-plaintext highlighter-rouge">vi /etc/pam.d/system-auth</code>)</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/lib/security/<span class="nv">$ISA</span>/pam_cracklib.so <span class="nv">retry</span><span class="o">=</span>3 <span class="nv">minlen</span><span class="o">=</span>8 <span class="nv">lcredit</span><span class="o">=</span><span class="nt">-1</span> <span class="nv">ucredit</span><span class="o">=</span><span class="nt">-2</span> <span class="nv">dcredit</span><span class="o">=</span><span class="nt">-2</span> <span class="nv">ocredit</span><span class="o">=</span><span class="nt">-1</span>
</pre></table></code></div></div><h4 id="10-enable-iptables-firewall"><span class="mr-2">10. Enable Iptables (Firewall)</span><a href="#10-enable-iptables-firewall" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>It’s highly recommended to enable the Linux firewall to secure access to your servers. Apply rules in iptables to filter incoming, outgoing and forwarding packets. We can specify the source and destination address to allow and deny specific udp/tcp port number.</p><p>The following are rules i would highly recommend adding to yours (<code class="language-plaintext highlighter-rouge">vi /etc/sysconfig/iptables</code>) the first block of rules drop connections that are not recognised, the second allows local network access to certain ports e.g. SSH port 22.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>Generated by iptables-save v1.4.7 on Mon Mar 31 14:07:57 2014
<span class="k">*</span>filter
:INPUT DROP <span class="o">[</span>0:0]
:FORWARD DROP <span class="o">[</span>0:0]
:OUTPUT ACCEPT <span class="o">[</span>7:747]
<span class="nt">-A</span> INPUT <span class="nt">-i</span> lo <span class="nt">-j</span> ACCEPT
<span class="nt">-A</span> INPUT <span class="nt">-m</span> state <span class="nt">--state</span> RELATED,ESTABLISHED <span class="nt">-j</span> ACCEPT
<span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">-m</span> tcp <span class="nt">--tcp-flags</span> FIN,SYN,RST,PSH,ACK,URG NONE <span class="nt">-j</span> DROP
<span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">-m</span> tcp <span class="o">!</span> <span class="nt">--tcp-flags</span> FIN,SYN,RST,ACK SYN <span class="nt">-m</span> state <span class="nt">--state</span> NEW <span class="nt">-j</span> DROP
<span class="nt">-A</span> INPUT <span class="nt">-p</span> tcp <span class="nt">-m</span> tcp <span class="nt">--tcp-flags</span> FIN,SYN,RST,PSH,ACK,URG FIN,SYN,RST,PSH,ACK,URG <span class="nt">-j</span> DROP
<span class="nt">-A</span> INPUT <span class="nt">-f</span> <span class="nt">-j</span> DROP

<span class="nt">-A</span> INPUT <span class="nt">-s</span> 192.168.0.0/24 <span class="nt">-p</span> icmp <span class="nt">--icmp-type</span> any <span class="nt">-j</span> ACCEPT
<span class="nt">-A</span> INPUT <span class="nt">-s</span> 192.168.0.0/24 <span class="nt">-i</span> eth0 <span class="nt">-p</span> tcp <span class="nt">-m</span> tcp <span class="nt">--dport</span> 22 <span class="nt">-j</span> ACCEPT
</pre></table></code></div></div><h4 id="11-keep-boot-as-read-only"><span class="mr-2">11. Keep /boot as read-only</span><a href="#11-keep-boot-as-read-only" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>The Linux kernel and its related files are in <code class="language-plaintext highlighter-rouge">/boot</code> directory which is by default read-write. Changing it to read-only reduces the risk of unauthorised modification of critical boot files. To do this, <code class="language-plaintext highlighter-rouge">vi /etc/fstab</code> and add the following to the bottom.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">LABEL</span><span class="o">=</span>/boot     /boot     ext2     defaults,ro     1 2
</pre></table></code></div></div><blockquote class="prompt-info"><div><p>You need to reset the change to read-write if you need to upgrade the kernel in future.</p></div></blockquote><h4 id="12-setup-ntp"><span class="mr-2">12. Setup NTP</span><a href="#12-setup-ntp" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>Having an accurate system clock is important for reviewing log files and determining when an event occurred. Often system clocks can become out of sync or be reset to an older date and this can cause havoc with tracking of errors. Consider creating a Cron job rather than running ntpd to update the time daily or hourly with a common source for all servers.</p><h4 id="13-install-ddos-deflate"><span class="mr-2">13. Install DDoS Deflate</span><a href="#13-install-ddos-deflate" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>DDoS Deflate is a lightweight bash shell script designed to assist in the process of blocking a denial of service attack. It uses the command below to create a list of IP addresses connected to the server, along with their total number of connections.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>netstat <span class="nt">-ntu</span> | <span class="nb">awk</span> ‘<span class="o">{</span>print <span class="nv">$5</span><span class="o">}</span>’ | <span class="nb">cut</span> <span class="nt">-d</span>: <span class="nt">-f1</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-n</span>
</pre></table></code></div></div><h5 id="features-of-ddos-deflate"><span class="mr-2">Features of (D)DoS Deflate</span><a href="#features-of-ddos-deflate" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><p>Configuration file: /usr/local/ddos/ddos.conf To whitelist IP address, use /usr/local/ddos/ignore.ip.list. It is having a feature to unblock IP addresses automatically after a preconfigured time limit. You can execute the script at a chosen frequency. You will get email alerts when IP addresses are blocked.</p><h5 id="installation"><span class="mr-2">Installation</span><a href="#installation" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>wget http://www.inetbase.com/scripts/ddos/install.sh
<span class="nb">chmod </span>0700 install.sh
./install.sh
</pre></table></code></div></div><h5 id="uninstallation"><span class="mr-2">Uninstallation</span><a href="#uninstallation" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>wget http://www.inetbase.com/scripts/ddos/uninstall.ddos
<span class="nb">chmod </span>0700 uninstall.ddos
./uninstall.ddos
</pre></table></code></div></div><h5 id="script-to-check-no-of-connected-ips"><span class="mr-2">Script to check No of connected ip’s.</span><a href="#script-to-check-no-of-connected-ips" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sh /usr/local/ddos/ddos.sh
</pre></table></code></div></div><h5 id="restart-ddos-deflate"><span class="mr-2">Restart DDos Deflate</span><a href="#restart-ddos-deflate" class="anchor text-muted"><i class="bi bi-hash"></i></a></h5><div class="language-sh highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sh /usr/local/ddos/ddos.sh <span class="nt">-c</span>
</pre></table></code></div></div><h4 id="14-install-denyhosts"><span class="mr-2">14. Install DenyHosts</span><a href="#14-install-denyhosts" class="anchor text-muted"><i class="bi bi-hash"></i></a></h4><p>DenyHosts is a security tool written in python that monitors server access logs to prevent brute force attacks on a virtual server. The program works by banning IP addresses that exceed a certain number of failed login attempts.</p><hr /><p>This list is still not completed, I am constantly adding new security tips to it, should you have any you think I should include please comment below and I will add them.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="bi bi-folder2-open mr-1"></i> <a href="/categories/linux/" >Linux</a >, <a href="/categories/security/" >Security</a ></div><div class="post-tags"> <i class="bi bi-tags mr-1"></i> <a href="/tags/hardening/" class="post-tag no-text-decoration" >hardening</a> <a href="/tags/security/" class="post-tag no-text-decoration" >security</a> <a href="/tags/vuln/" class="post-tag no-text-decoration" >vuln</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2" ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=CentOS+Server+Hardening+Tips+-+TotalDebug&url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fcentos-server-hardening-tips%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="bi bi-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=CentOS+Server+Hardening+Tips+-+TotalDebug&u=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fcentos-server-hardening-tips%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="bi bi-facebook"></i> </a> <a href="https://telegram.me/share?text=CentOS+Server+Hardening+Tips+-+TotalDebug&url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fcentos-server-hardening-tips%2F" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="bi bi-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=CentOS+Server+Hardening+Tips+-+TotalDebug&u=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fcentos-server-hardening-tips%2F" data-toggle="tooltip" data-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews" > <i class="bi bi-hacker-news"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fcentos-server-hardening-tips%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="bi bi-linkedin"></i> </a> <i id="copy-link" class="bi bi-link-45deg small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/using-clonezilla-to-migrate-multi-disk-server/">Using CloneZilla to migrate multiple disk server</a><li><a href="/posts/how-to-make-the-shutdown-button-unavailable-with-group-policy/">How to Make the Shutdown Button Unavailable with Group Policy</a><li><a href="/posts/synchronize-time-with-external-ntp-server-on-windows-server/">Synchronise time with external NTP server on Windows Server</a><li><a href="/posts/send-on-behalf-and-send-as/">Send on Behalf and Send As</a><li><a href="/posts/server-2003-reinstall-terminal-services-licensing/">Server 2003 Reinstall Terminal Services Licensing.</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/centos/">centos</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unifi/">unifi</a> <a class="post-tag" href="/tags/best-practices/">best practices</a> <a class="post-tag" href="/tags/code-quality/">code quality</a> <a class="post-tag" href="/tags/configuration/">configuration</a> <a class="post-tag" href="/tags/container/">container</a> <a class="post-tag" href="/tags/exchange/">exchange</a> <a class="post-tag" href="/tags/usg/">usg</a></div></div></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/use-google-authenticator-ssh/"><div class="card-body"> <em class="small" data-ts="1389139200" data-df="ll" > Jan 8, 2014 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Use Google Authenticator for SSH</h3><div class="text-muted small"><p> I have recently setup two factor authentication on my server using Google Authenticator, I thought it would be a good idea to share with you guys the way I achieved this and some issues I bumped in...</p></div></div></a></div><div class="card"> <a href="/posts/centos-public-private-key-auth/"><div class="card-body"> <em class="small" data-ts="1390176000" data-df="ll" > Jan 20, 2014 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CentOS Use Public/Private Keys for Authentication</h3><div class="text-muted small"><p> The following Tutorial walks you through how to setup authentication using a key pair to negotiate the connection, stopping the requirement for passwords. 1.First, create a public/private key pai...</p></div></div></a></div><div class="card"> <a href="/posts/setup-rsnapshot-backups-centos/"><div class="card-body"> <em class="small" data-ts="1390262400" data-df="ll" > Jan 21, 2014 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Setup rSnapshot backups on CentOS</h3><div class="text-muted small"><p> In this article I will be talking you through how to use rSnapshot and rSync to backup your server with an email alert when the backup has been completed and what has been backed up. You must ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/teamspeak-3-mysql-centos-6-x/" class="btn btn-outline-primary" prompt="Older"><p>Teamspeak 3 with MySQL on CentOS 6.x (before 3.0.11.1)</p></a> <a href="/posts/email-report-virtual-machines-snapshots/" class="btn btn-outline-primary" prompt="Newer"><p>Email Report Virtual Machines with Snapshots</p></a></div><script type="text/javascript"> $(function () { const origin = "https://giscus.app"; const iframe = "iframe.giscus-frame"; const lightTheme = "light"; const darkTheme = "dark_dimmed"; let initTheme = lightTheme; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = darkTheme; } let giscusAttributes = { "src": "https://giscus.app/client.js", "data-repo": "totaldebug/totaldebug.uk", "data-repo-id": "MDEwOlJlcG9zaXRvcnkzMTkxMTkxNTE=", "data-category": "General", "data-category-id": "DIC_kwDOEwVfL84CPpH4", "data-mapping": "pathname", "data-reactions-enabled": "1", "data-emit-metadata": "0", "data-theme": initTheme, "data-input-position": "bottom", "data-lang": "", "crossorigin": "anonymous", "async": "" }; let giscusScript = document.createElement("script"); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value)); document.getElementById("tail-wrapper").appendChild(giscusScript); addEventListener("message", (event) => { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* global theme mode changed */ const mode = event.data.message; const theme = (mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme); const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); }); </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/centos/">centos</a> <a class="post-tag" href="/tags/docker/">docker</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/unifi/">unifi</a> <a class="post-tag" href="/tags/best-practices/">best practices</a> <a class="post-tag" href="/tags/code-quality/">code quality</a> <a class="post-tag" href="/tags/configuration/">configuration</a> <a class="post-tag" href="/tags/container/">container</a> <a class="post-tag" href="/tags/exchange/">exchange</a> <a class="post-tag" href="/tags/usg/">usg</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/marksie1988">Steven Marks</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button" > <i class="bi bi-chevron-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false" ><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close" > <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"> A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="bi bi-folder"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="bi bi-tag"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-ZDGYQV98HT"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-ZDGYQV98HT'); }); </script>
