<!doctype html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Use Python pandas NOW for your big datasets" /><meta name="author" content="Steven Marks" /><meta property="og:locale" content="en" /><meta name="description" content="Over the past few years I have been working on processing large analytical data sets requiring various manipulations to produce statistics for analysis and business improvement." /><meta property="og:description" content="Over the past few years I have been working on processing large analytical data sets requiring various manipulations to produce statistics for analysis and business improvement." /><link rel="canonical" href="https://totaldebug.uk/posts/use-python-pandas-now/" /><meta property="og:url" content="https://totaldebug.uk/posts/use-python-pandas-now/" /><meta property="og:site_name" content="TotalDebug" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-03-29T17:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Use Python pandas NOW for your big datasets" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Steven Marks"},"dateModified":"2023-03-29T17:00:00+01:00","datePublished":"2023-03-29T17:00:00+01:00","description":"Over the past few years I have been working on processing large analytical data sets requiring various manipulations to produce statistics for analysis and business improvement.","headline":"Use Python pandas NOW for your big datasets","mainEntityOfPage":{"@type":"WebPage","@id":"https://totaldebug.uk/posts/use-python-pandas-now/"},"url":"https://totaldebug.uk/posts/use-python-pandas-now/"}</script><title>Use Python pandas NOW for your big datasets | TotalDebug</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="TotalDebug"><meta name="application-name" content="TotalDebug"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.3/font/bootstrap-icons.css" /><link rel="stylesheet" href="/assets/css/style.css" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/logo.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><div class="site-title"> <a href="/">TotalDebug</a></div><div class="site-subtitle fst-italic">Technology. Inside Out</div></div><ul class="nav flex-column flex-grow-1 w-100 ps-0"><li class="nav-item"> <a href="/" class="nav-link"> <i class="bi bi-house ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="bi bi-list-nested ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="bi bi-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="bi bi-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="bi bi-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/works/" class="nav-link"> <i class="bi bi-kanban ml-xl-3 mr-xl-3 unloaded"></i> <span>WORKS</span> </a></ul><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/marksie1988" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="bi bi-github"></i> </a> <a href="https://www.linkedin.com/in/marksie1988" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="bi bi-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="bi bi-rss"></i> </a> <a href="https://discord.gg/6fmekudc8Q" aria-label="discord" > <i class="bi bi-discord"></i> </a></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container px-xxl-5"><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100" > <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Use Python pandas NOW for your big datasets</span> </span> <i id="sidebar-trigger" class="bi bi-list"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="bi bi-search"></i> <span id="search-wrapper" class="align-items-center"> <i class="bi bi-search"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel">Cancel</span></div></div><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pe-xl-4"><div class="post px-1 px-md-2"><h1 data-toc-skip>Use Python pandas NOW for your big datasets</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1680105600" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Mar 29, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/marksie1988">Steven Marks</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="916 words" > <em>5 min</em> read</span></div></div></div><div class="d-none"><div id="posted-date">1680105600</div><div id="updated-date"></div></div><blockquote class="d-none prompt-info" id="post-age-notification"></blockquote><div class="post-content"><p>Over the past few years I have been working on processing large analytical data sets requiring various manipulations to produce statistics for analysis and business improvement.</p><p>I quickly found that processing data of this size was slow, some taking over 11 hours to process which would only get worse as the data grew.</p><p>Most of the processing required multiple nested for loops and addition of columns to json formatted data, this had some large processing requirements and multi threaded processing wouldn’t help in these scenarios.</p><p>I knew there had to be a better way to process this data faster, and so I looked into using pandas.</p><h2 id="what-is-pandas"><span class="me-2">What is pandas?</span><a href="#what-is-pandas" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><p>pandas is a software library written for the Python programming language for data manipulation and analysis. In particular, it offers data structures and operations for manipulating numerical tables and time series.</p><h2 id="test-results"><span class="me-2">Test results</span><a href="#test-results" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><p>I ran some testing on 100 rows of data, one using for loops and one using pandas. With for loops the test took <code class="language-plaintext highlighter-rouge">19.09s</code> to complete, with pandas an impressive <code class="language-plaintext highlighter-rouge">1.21s</code> an improvement of <code class="language-plaintext highlighter-rouge">17.88s</code>. When I run this on the full dataset which currently sits at around 16,500 rows it takes <code class="language-plaintext highlighter-rouge">33.15s</code> seconds, an impressive improvement from a full run with for loops (which I had to cancel after 3 hours, it took too long for my requirements).</p><h2 id="pandas-first-steps"><span class="me-2">Pandas first steps</span><a href="#pandas-first-steps" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><h3 id="install-and-import"><span class="me-2">Install and import</span><a href="#install-and-import" class="anchor text-muted"><i class="bi bi-hash"></i></a></h3><p>Pandas is an easy package to install. Open up your terminal program (for Mac users) or command line (for PC users) and install it using either of the following commands:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>poetry <span class="nb">install </span>pandas
</pre></table></code></div></div><p>OR</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>pip <span class="nb">install </span>pandas
</pre></table></code></div></div><p>Alternatively, if you’re currently viewing this article in a Jupyter notebook you can run this cell:</p><pre><code class="language-jupyter">!pip install pandas
</code></pre><p>The <code class="language-plaintext highlighter-rouge">!</code> at the beginning runs cells as if they were in a terminal.</p><p>To import pandas we usually import it with a shorter name since it’s used so much:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">pandas</span> <span class="k">as</span> <span class="n">pd</span>
</pre></table></code></div></div><h2 id="series-and-dataframe"><span class="me-2">Series and DataFrame</span><a href="#series-and-dataframe" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><p>The two main components of pandas are <code class="language-plaintext highlighter-rouge">Series</code> and <code class="language-plaintext highlighter-rouge">DataFrame</code>.</p><p>A <code class="language-plaintext highlighter-rouge">Series</code> is a column and a <code class="language-plaintext highlighter-rouge">DataFrame</code> is a table made up of a collection of Series.</p><picture> <source type="image/webp" srcset="/assets/img/posts/use-python-pandas-now/series_dataframe.webp" /> <a href="/assets/img/posts/use-python-pandas-now/series_dataframe.png" class="popup img-link "><img data-src="/assets/img/posts/use-python-pandas-now/series_dataframe.png" alt="Series DataFrame" class="lazyload" data-proofer-ignore></a> </picture><p>DataFrames and Series are quite similar in that most operations that you can do with one you can do with the other.</p><h2 id="creating-a-dataframe"><span class="me-2">Creating a DataFrame</span><a href="#creating-a-dataframe" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><p>DataFrames can be created multiple ways, I use PostgreSQL and BigQuery, using the pandas <code class="language-plaintext highlighter-rouge">read_sql</code> and <code class="language-plaintext highlighter-rouge">read_gbq</code> the data is automatically placed into a DataFrame.</p><p>Also we can manually create a DataFrame, using Python <code class="language-plaintext highlighter-rouge">dict</code> and <code class="language-plaintext highlighter-rouge">list</code> which is great for testing.</p><p>Taking our example in the diagram above, we have how many cars have sold each day. To organize this as a dictionary for pandas we could do something like:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">sales_data</span> <span class="o">=</span> <span class="p">{</span>
  <span class="sh">'</span><span class="s">Audi</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
  <span class="sh">'</span><span class="s">BMW</span><span class="sh">'</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="p">}</span>
<span class="n">sales</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">sales_data</span><span class="p">)</span>
</pre></table></code></div></div><p>We would then see the data in the DataFrame format below:</p><picture> <source type="image/webp" srcset="/assets/img/posts/use-python-pandas-now/dataframe.webp" /> <a href="/assets/img/posts/use-python-pandas-now/dataframe.png" class="popup img-link "><img data-src="/assets/img/posts/use-python-pandas-now/dataframe.png" alt="DaraFrame" class="lazyload" data-proofer-ignore></a> </picture><p>As you can see, each <code class="language-plaintext highlighter-rouge">key</code> from the dictionary is converted to a column, and the <code class="language-plaintext highlighter-rouge">values</code> are all put into a new row on the corresponding column</p><p>The Index of this DataFrame is given on creation, as numbers 0-3, but we could also create our own when we initialize the DataFrame.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">sales</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="nc">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="sh">'</span><span class="s">Jan</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Feb</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Mar</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">Apr</span><span class="sh">'</span><span class="p">])</span>
</pre></table></code></div></div><h2 id="iterating-data"><span class="me-2">Iterating data</span><a href="#iterating-data" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><p>Normally with Python you would create iterate through data using a for loop to check every column, to do this with a DataFrame it would looks like this:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">sale</span> <span class="ow">in</span> <span class="n">sales</span><span class="p">.</span><span class="nf">itterrows</span><span class="p">():</span>
  <span class="k">if</span> <span class="n">sale</span><span class="p">[</span><span class="sh">'</span><span class="s">Audi</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Audi Targets hit with </span><span class="si">{</span><span class="n">sale</span><span class="p">[</span><span class="sh">'</span><span class="s">Audi</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> sales.</span><span class="sh">"</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">sale</span><span class="p">[</span><span class="sh">'</span><span class="s">BMW</span><span class="sh">'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">BMW Targets hit with </span><span class="si">{</span><span class="n">sale</span><span class="p">[</span><span class="sh">'</span><span class="s">BMW</span><span class="sh">'</span><span class="p">]</span><span class="si">}</span><span class="s"> sales.</span><span class="sh">"</span><span class="p">)</span>
</pre></table></code></div></div><p>This way of iterating through data is slow, I found this when I needed to do multiple nested for loops over multiple DataFrames.</p><p>However, there is a much faster and more efficient way to do this using the pandas <code class="language-plaintext highlighter-rouge">loc</code> function. So now we could <strong>loc</strong>ate a specific month’s order by using the month name:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="n">sales</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="sh">'</span><span class="s">Feb</span><span class="sh">'</span><span class="p">]</span>

<span class="n">Audi</span>  <span class="mi">3</span>
<span class="n">BMW</span>   <span class="mi">0</span>
<span class="n">Name</span><span class="p">:</span> <span class="n">Jan</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">int64</span>
</pre></table></code></div></div><p>This example is quite simple, but we can get more complex with different data, for example if you had a list of servers with their operating systems you could find all server OS’s with “Windows” in the name and create a new column “OS Type” with “Windows” as the value to quickly filter by all Windows devices.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">servers</span><span class="p">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">servers</span><span class="p">[</span><span class="sh">'</span><span class="s">os</span><span class="sh">'</span><span class="p">].</span><span class="nf">isna</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">servers</span><span class="p">[</span><span class="sh">'</span><span class="s">os</span><span class="sh">'</span><span class="p">].</span><span class="nf">contains</span><span class="p">(</span><span class="sh">"</span><span class="s">Windows</span><span class="sh">"</span><span class="p">).</span><span class="nf">lower</span><span class="p">(),</span> <span class="sh">"</span><span class="s">OS Type</span><span class="sh">"</span><span class="p">]</span> <span class="o">=</span> <span class="sh">"</span><span class="s">Windows</span><span class="sh">"</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">servers</code> - is our DataFrame<li><code class="language-plaintext highlighter-rouge">.loc[]</code> - Allows access to a group of rows and columns by labels or boolean array<li><code class="language-plaintext highlighter-rouge">~servers['os'].isna()</code> - checks that the <code class="language-plaintext highlighter-rouge">os</code> column has a value<li><code class="language-plaintext highlighter-rouge">servers['os'].contains("Windows").lower()</code> - Checks that the <code class="language-plaintext highlighter-rouge">os</code> column has <code class="language-plaintext highlighter-rouge">windows</code> in the name and converts it to lower case to ensure all matches are not case sensitive.<li><code class="language-plaintext highlighter-rouge">OS Type</code> is the column to update if the statements match<li><code class="language-plaintext highlighter-rouge">= "Windows"</code> is the value to update the column with</ul><p>Below would be the expected output from this Dataframe manipulation.</p><picture> <source type="image/webp" srcset="/assets/img/posts/use-python-pandas-now/os_dataframe_example.webp" /> <a href="/assets/img/posts/use-python-pandas-now/os_dataframe_example.png" class="popup img-link "><img data-src="/assets/img/posts/use-python-pandas-now/os_dataframe_example.png" alt="OS Dataframe Example" class="lazyload" data-proofer-ignore></a> </picture><h2 id="merging-dadaframes"><span class="me-2">Merging DadaFrames</span><a href="#merging-dadaframes" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><p>Much like doing a join with a SQL table, you can merge DataFrames based on specific columns:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="bi bi-code-slash small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="bi bi-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="n">pd</span><span class="p">.</span><span class="nf">merge</span><span class="p">(</span>
        <span class="n">devices</span><span class="p">,</span>
        <span class="n">os_data</span><span class="p">[</span>
            <span class="p">[</span>
                <span class="sh">"</span><span class="s">device_name</span><span class="sh">"</span><span class="p">,</span>
                <span class="sh">"</span><span class="s">operating_system</span><span class="sh">"</span>
            <span class="p">]</span>
        <span class="p">],</span>
        <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="sh">"</span><span class="s">device_name</span><span class="sh">"</span><span class="p">],</span>
        <span class="n">how</span><span class="o">=</span><span class="sh">"</span><span class="s">left</span><span class="sh">"</span><span class="p">,</span>
    <span class="p">)</span>

</pre></table></code></div></div><h2 id="final-thoughts"><span class="me-2">Final Thoughts</span><a href="#final-thoughts" class="anchor text-muted"><i class="bi bi-hash"></i></a></h2><p>There is much more that can be done with pandas and DataFrames, this just scratches the surface and gives a very basic overview. The main reason for writing this article is to show what a difference in performance is made from using pandas, if you aren’t using this for your data yet, I recommend that you do!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="bi bi-folder2-open mr-1"></i> <a href="/categories/python/" >Python</a ></div><div class="post-tags"> <i class="bi bi-tags mr-1"></i> <a href="/tags/pandas/" class="post-tag no-text-decoration" >pandas</a> <a href="/tags/bigdata/" class="post-tag no-text-decoration" >bigdata</a> <a href="/tags/dataframes/" class="post-tag no-text-decoration" >dataframes</a> <a href="/tags/performance/" class="post-tag no-text-decoration" >performance</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2" ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Use%20Python%20pandas%20NOW%20for%20your%20big%20datasets%20-%20TotalDebug&url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fuse-python-pandas-now%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw bi bi-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Use%20Python%20pandas%20NOW%20for%20your%20big%20datasets%20-%20TotalDebug&u=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fuse-python-pandas-now%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw bi bi-facebook"></i> </a> <a href="https://telegram.me/share?text=Use%20Python%20pandas%20NOW%20for%20your%20big%20datasets%20-%20TotalDebug&url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fuse-python-pandas-now%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw bi bi-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=Use%20Python%20pandas%20NOW%20for%20your%20big%20datasets%20-%20TotalDebug&u=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fuse-python-pandas-now%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews" > <i class="fa-fw bi bi-hacker-news"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fuse-python-pandas-now%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw bi bi-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/automated-release-with-semantic-release-and-commitizen/">Automated release with Semantic Release and commitizen</a><li class="text-truncate lh-lg"> <a href="/posts/sunsynk-power-flow-card-with-lux-inverter/">Setup the Sunsynk Power Flow Card with a Lux Inverter</a><li class="text-truncate lh-lg"> <a href="/posts/solcast-api-home-assistant/">Integrate Solcast API with Home Assistant</a><li class="text-truncate lh-lg"> <a href="/posts/integrate-lux-inverter-with-home-assistant/">Integrating a Lux Power Inverter with Home Assistant</a><li class="text-truncate lh-lg"> <a href="/posts/automating-proxmox-with-terraform-ansible/">Automating deployments using Terraform with Proxmox and ansible</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/centos/">centos</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/unifi/">unifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/best-practices/">best practices</a> <a class="post-tag btn btn-outline-primary" href="/tags/code-quality/">code quality</a> <a class="post-tag btn btn-outline-primary" href="/tags/home-assistant/">home-assistant</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/configuration/">configuration</a> <a class="post-tag btn btn-outline-primary" href="/tags/container/">container</a></div></div></div><div id="toc-wrapper" class="ps-0 pe-4 mb-5"><div class="panel-heading ps-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-3 pe-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ms-1" data-toc-skip> Further Reading</h3><div class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><div class="col"> <a href="/posts/hll-better-performance-visibility/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1692350075" data-df="ll" > Aug 18, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>Hell Let Loose, better performance and visibility settings</h4><div class="text-muted small"><p> For anyone playing Hell Let Loose, you will have come across the annoyance of never being able to spot your enemy but they always seem to get you, Well the chances are they were using the settings ...</p></div></div></a></div><div class="col"> <a href="/posts/python-method-aliases/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1691487577" data-df="ll" > Aug 8, 2023 </em><h4 class="pt-0 my-2" data-toc-skip>A Pythonic way to alias methods?</h4><div class="text-muted small"><p> An alias method allows accesses to the original method via a different name. You can define your own alias method by adding the statement a = b to your class definition. This creates an alias metho...</p></div></div></a></div><div class="col"> <a href="/posts/creating-the-perfect-python-project/" class="card post-preview h-100"><div class="card-body"> <em class="small" data-ts="1647990000" data-df="ll" > Mar 22, 2022 </em><h4 class="pt-0 my-2" data-toc-skip>Creating the perfect Python project</h4><div class="text-muted small"><p> Working on a new project its always exciting to jump straight in and get coding without any setup time. However spending a small amount of time to setup the project with the best tools and practice...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/how-i-host-this-site/" class="btn btn-outline-primary" prompt="Older" ><p>How I host this site</p></a> <a href="/posts/automating-proxmox-with-terraform-ansible/" class="btn btn-outline-primary" prompt="Newer" ><p>Automating deployments using Terraform with Proxmox and ansible</p></a></div><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'totaldebug/totaldebug.uk', 'data-repo-id': 'MDEwOlJlcG9zaXRvcnkzMTkxMTkxNTE=', 'data-category': 'General', 'data-category-id': 'DIC_kwDOEwVfL84CPpH4', 'data-mapping': 'pathname', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/centos/">centos</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/unifi/">unifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/best-practices/">best practices</a> <a class="post-tag btn btn-outline-primary" href="/tags/code-quality/">code quality</a> <a class="post-tag btn btn-outline-primary" href="/tags/home-assistant/">home-assistant</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/configuration/">configuration</a> <a class="post-tag btn btn-outline-primary" href="/tags/container/">container</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div></div><footer><div class="container px-lg-4"><div class="d-flex justify-content-center align-items-center text-muted mx-md-3"><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p><p>© 2023 <a href="https://github.com/marksie1988">Steven Marks</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p></div></div></footer><div id="mask"></div><button id="back-to-top" aria-label="back-to-top" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button> <script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.6.1/dist/jquery.min.js,npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js,npm/tocbot@4.20.1/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-ZDGYQV98HT"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-ZDGYQV98HT'); }); </script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="card post-preview"> <a style="text-decoration: none;" href="{url}"><div class="card-body"><h1 class="card-title"> {title}</h1><div class="card-text post-content"> {snippet}</div><div class="post-meta text-muted d-flex"><div class="mr-auto"> {categories} {tags}</div></div></div></a></div>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<i class="bi bi-folder"></i>${value}`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<i class="bi bi-tag"></i>${value}`; } } } }); </script>
