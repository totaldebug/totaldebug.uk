<!doctype html><html lang="en" data-mode="dark"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Proxmox Template with Cloud Image and Cloud Init" /><meta name="author" content="Steven Marks" /><meta property="og:locale" content="en" /><meta name="description" content="Updated to latest Ubuntu image &amp; Added enable for qemu service" /><meta property="og:description" content="Updated to latest Ubuntu image &amp; Added enable for qemu service" /><link rel="canonical" href="https://totaldebug.uk/posts/proxmox-template-with-cloud-image-and-cloud-init/" /><meta property="og:url" content="https://totaldebug.uk/posts/proxmox-template-with-cloud-image-and-cloud-init/" /><meta property="og:site_name" content="TotalDebug" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-04T19:54:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Proxmox Template with Cloud Image and Cloud Init" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Steven Marks"},"dateModified":"2023-06-08T15:10:06+01:00","datePublished":"2022-10-04T19:54:00+01:00","description":"Updated to latest Ubuntu image &amp; Added enable for qemu service","headline":"Proxmox Template with Cloud Image and Cloud Init","mainEntityOfPage":{"@type":"WebPage","@id":"https://totaldebug.uk/posts/proxmox-template-with-cloud-image-and-cloud-init/"},"url":"https://totaldebug.uk/posts/proxmox-template-with-cloud-image-and-cloud-init/"}</script><title>Proxmox Template with Cloud Image and Cloud Init | TotalDebug</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="TotalDebug"><meta name="application-name" content="TotalDebug"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"> <img src="/assets/img/logo.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"> </a><h1 class="site-title"> <a href="/">TotalDebug</a></h1><p class="site-subtitle fst-italic mb-0">Technology. Inside Out</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw bi bi-list-nested"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw bi bi-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw bi bi-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw bi bi-info-circle"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/works/" class="nav-link"> <i class="fa-fw bi bi-kanban"></i> <span>WORKS</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <a href="https://github.com/marksie1988" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="bi bi-github"></i> </a> <a href="https://www.linkedin.com/in/marksie1988" aria-label="linkedin" target="_blank" rel="noopener noreferrer" > <i class="bi bi-linkedin"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="bi bi-rss"></i> </a> <a href="https://discord.gg/6fmekudc8Q" aria-label="discord" > <i class="bi bi-discord"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Proxmox Template with Cloud Image and Cloud Init</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link"> <i class="fas fa-search fa-fw"></i> </button> <search class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1"><header><h1 data-toc-skip>Proxmox Template with Cloud Image and Cloud Init</h1><div class="post-meta text-muted"> <span> Posted <time data-ts="1664909640" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Oct 4, 2022 </time> </span> <span> Updated <time data-ts="1686233406" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Jun 8, 2023 </time> </span><div class="mt-3 mb-3"> <a href="{name=" class="popup img-link shimmer"><img src="{"name"= loading="lazy"></a>"thumb.png"}" class="preview-img" alt="Preview Image" w="1200" h="630" ></div><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/marksie1988">Steven Marks</a> </em> </span> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="678 words" > <em>3 min</em> read</span></div></div><div class="row justify-content-center" id="post-series"><div class="card series-list"><div class="card-header"> AUTOMATING PROXMOX DEPLOYMENTS (2 part series)</div><ul class="list-group list-group-flush"> <a href="#" class="list-group-item list-group-item-action active" aria-current="true">Proxmox Template with Cloud Image and Cloud Init</a> <a href="/posts/automating-proxmox-with-terraform-ansible/" class="list-group-item list-group-item-action">Automating deployments using Terraform with Proxmox and ansible</a></ul></div></div></header><div class="content"><blockquote class="prompt-info"><p>Updated to latest Ubuntu image &amp; Added enable for qemu service</p></blockquote><p>Using Cloud images and Cloud init with Proxmox is the quickest, most efficient way to deploy servers at this time. Cloud images are small cloud certified that have Cloud init pre-installed and ready to accept configuration.</p><p>Cloud images and Cloud init also work with Proxmox and if you combine this with Terraform you have a fully automated deployment model. See <a href="/posts/automating-proxmox-with-terraform-ansible/">Automating deployments using Terraform with Proxmox and ansible</a> for instructions on how to do this. int</p><h2 id="guide"><span class="me-2">Guide</span><a href="#guide" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="download-image"><span class="me-2">Download image</span><a href="#download-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>First you will need to choose an <a href="https://cloud-images.ubuntu.com/">Ubuntu Cloud Image</a></p><p>Rather than downloading this, copy the URL.</p><p>Then SSH into your Proxmox server and run wget with the URL you just copied, similar to below:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>wget https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img
</pre></table></code></div></div><p>This will download the image onto your proxmox server ready for use.</p><h3 id="install-packages"><span class="me-2">Install packages</span><a href="#install-packages" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>The <code class="language-plaintext highlighter-rouge">qemu-guest-agent</code> is not installed on the cloud-images, so we need a way to inject that into out image file. This can be done with a great tool called <code class="language-plaintext highlighter-rouge">virt-customize</code> this is installed with the package <code class="language-plaintext highlighter-rouge">libguestfs-tools</code>. <a href="https://www.libguestfs.org/">libguestfs</a> is a set of tools for accessing and modifying virtual machine (VM) disk images.</p><p>Install:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>apt update <span class="nt">-y</span> <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>apt <span class="nb">install </span>libguestfs-tools <span class="nt">-y</span>
</pre></table></code></div></div><p>Install <code class="language-plaintext highlighter-rouge">qemu-guest-agent</code> into the downloaded image:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>virt-customize <span class="nt">-a</span> jammy-server-cloudimg-amd64.img <span class="nt">--install</span> qemu-guest-agent <span class="nt">--run-command</span> <span class="s1">'systemctl enable qemu-guest-agent.service'</span>
</pre></table></code></div></div><p>You can also install other packages at this point.</p><h3 id="adding-users-to-the-image-optional"><span class="me-2">Adding users to the image (Optional)</span><a href="#adding-users-to-the-image-optional" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>It is possible to also add a user and SSH keys with the <code class="language-plaintext highlighter-rouge">virt-customize</code>. This is useful for automation such as terraform.</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>virt-customize <span class="nt">-a</span> jammy-server-cloudimg-amd64.img <span class="nt">--run-command</span> <span class="s1">'useradd simone'</span>
<span class="nb">sudo </span>virt-customize <span class="nt">-a</span> jammy-server-cloudimg-amd64.img <span class="nt">--run-command</span> <span class="s1">'mkdir -p /home/simone/.ssh'</span>
<span class="nb">sudo </span>virt-customize <span class="nt">-a</span> jammy-server-cloudimg-amd64.img <span class="nt">--ssh-inject</span> simone:file:id_ed25519.pub
<span class="nb">sudo </span>virt-customize <span class="nt">-a</span> jammy-server-cloudimg-amd64.img <span class="nt">--run-command</span> <span class="s1">'chown -R simone:simone /home/simone'</span>
</pre></table></code></div></div><ol><li>Adds the user to the image<li>Makes the SSH Key directory<li>Injects the SSH Key. <code class="language-plaintext highlighter-rouge">simone</code> is the user the key will apply to, <code class="language-plaintext highlighter-rouge">file:id_ed25519.pub</code> is the file on the local host where the SSH Key is located<li>Makes sure the user simone owns the home folder</ol><h3 id="create-a-virtual-machine-from-the-image"><span class="me-2">Create a virtual machine from the image</span><a href="#create-a-virtual-machine-from-the-image" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now we need to create a new virtual machine:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm create 9000 <span class="nt">--memory</span> 2048 <span class="nt">--core</span> 2 <span class="nt">--name</span> jammy-template <span class="nt">--net0</span> virtio,bridge<span class="o">=</span>vmbr0
</pre></table></code></div></div><p>Import the downloaded Ubuntu disk to the correct storage:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm importdisk 9000 jammy-server-cloudimg-amd64.img local-lvm
</pre></table></code></div></div><p>Attach the new disk as a SCSI drive on the SCSI Controller:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm <span class="nb">set </span>9000 <span class="nt">--scsihw</span> virtio-scsi-pci <span class="nt">--scsi0</span> local-lvm:vm-9000-disk-0
</pre></table></code></div></div><p>Add cloud init drive:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm <span class="nb">set </span>9000 <span class="nt">--ide2</span> local-lvm:cloudinit
</pre></table></code></div></div><p>Make the could init drive bootable and restrict BIOS to boot from disk only:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm <span class="nb">set </span>9000 <span class="nt">--boot</span> c <span class="nt">--bootdisk</span> scsi0
</pre></table></code></div></div><p>Add serial console:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm <span class="nb">set </span>9000 <span class="nt">--serial0</span> socket <span class="nt">--vga</span> serial0
</pre></table></code></div></div><p>Turn on guest agent:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm <span class="nb">set </span>9000 <span class="nt">--agent</span> <span class="nv">enabled</span><span class="o">=</span>1
</pre></table></code></div></div><blockquote class="prompt-warning"><p>DO NOT POWER ON THE VM</p></blockquote><h3 id="convert-the-vm-to-a-template"><span class="me-2">Convert the VM to a Template</span><a href="#convert-the-vm-to-a-template" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Now, Create a template from the image you just created:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>qm template 9000
</pre></table></code></div></div><h2 id="clone-the-template-to-a-vm"><span class="me-2">Clone the template to a VM</span><a href="#clone-the-template-to-a-vm" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Now you have a fully functioning template, which can be cloned as much as you want. But it makes sense to set some of the settings.</p><p>First, clone the VM (here we are cloning the template with ID 9000 to a new VM with ID 999):</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>qm clone 9000 999 <span class="nt">--name</span> test-cloud-init
</pre></table></code></div></div><p>Next, set the SSH keys (if you didn’t add yours earlier) and IP address:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>qm <span class="nb">set </span>999 <span class="nt">--sshkey</span> ~/.ssh/id_rsa.pub
<span class="nb">sudo </span>qm <span class="nb">set </span>999 <span class="nt">--ipconfig0</span> <span class="nv">ip</span><span class="o">=</span>10.10.1.20/24,gw<span class="o">=</span>10.10.1.1
</pre></table></code></div></div><p>It’s now ready to start up!</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>qm start 999
</pre></table></code></div></div><p>You should be able to log in without any problems (after trusting the SSH fingerprint). Note that the username is <code class="language-plaintext highlighter-rouge">ubuntu</code>, for the key set here. If you added your own user earlier, you can use that instead</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ssh ubuntu@10.10.1.1
</pre></table></code></div></div><p>Once happy with the template, you can stop the VM and clean up the resources:</p><div class="language-shell highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nb">sudo </span>qm stop 999 <span class="o">&amp;&amp;</span> <span class="nb">sudo </span>qm destroy 999
<span class="nb">rm </span>jammy-server-cloudimg-amd64.img
</pre></table></code></div></div><h2 id="references"><span class="me-2">References</span><a href="#references" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><a href="https://registry.terraform.io/modules/sdhibit/cloud-init-vm/proxmox/latest/examples/ubuntu_single_vm">https://registry.terraform.io/modules/sdhibit/cloud-init-vm/proxmox/latest/examples/ubuntu_single_vm</a></p><h2 id="closing"><span class="me-2">Closing</span><a href="#closing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Hopefully this information was useful for you, If you have any questions about this article and share your thoughts head over to my <a href="https://discord.gg/6fmekudc8Q">Discord</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/automation/">Automation</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/proxmox/" class="post-tag no-text-decoration" >proxmox</a> <a href="/tags/ubuntu/" class="post-tag no-text-decoration" >ubuntu</a> <a href="/tags/cloud-init/" class="post-tag no-text-decoration" >cloud-init</a> <a href="/tags/cloud-image/" class="post-tag no-text-decoration" >cloud-image</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/clone/" class="post-tag no-text-decoration" >clone</a> <a href="/tags/template/" class="post-tag no-text-decoration" >template</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted me-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Proxmox%20Template%20with%20Cloud%20Image%20and%20Cloud%20Init%20-%20TotalDebug&url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fproxmox-template-with-cloud-image-and-cloud-init%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter" > <i class="fa-fw bi bi-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Proxmox%20Template%20with%20Cloud%20Image%20and%20Cloud%20Init%20-%20TotalDebug&u=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fproxmox-template-with-cloud-image-and-cloud-init%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook" > <i class="fa-fw bi bi-facebook"></i> </a> <a href="https://telegram.me/share?text=Proxmox%20Template%20with%20Cloud%20Image%20and%20Cloud%20Init%20-%20TotalDebug&url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fproxmox-template-with-cloud-image-and-cloud-init%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram" > <i class="fa-fw bi bi-telegram"></i> </a> <a href="https://news.ycombinator.com/submitlink?t=Proxmox%20Template%20with%20Cloud%20Image%20and%20Cloud%20Init%20-%20TotalDebug&u=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fproxmox-template-with-cloud-image-and-cloud-init%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="HackerNews" target="_blank" rel="noopener" aria-label="HackerNews" > <i class="fa-fw bi bi-hacker-news"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Ftotaldebug.uk%2Fposts%2Fproxmox-template-with-cloud-image-and-cloud-init%2F" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin" > <i class="fa-fw bi bi-linkedin"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 mb-5 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/hll-better-performance-visibility/">Hell Let Loose, better performance and visibility settings</a><li class="text-truncate lh-lg"> <a href="/posts/automated-release-with-semantic-release-and-commitizen/">Automated release with Semantic Release and commitizen</a><li class="text-truncate lh-lg"> <a href="/posts/sunsynk-power-flow-card-with-lux-inverter/">Setup the Sunsynk Power Flow Card with a Lux Inverter</a><li class="text-truncate lh-lg"> <a href="/posts/solcast-api-home-assistant/">Integrate Solcast API with Home Assistant</a><li class="text-truncate lh-lg"> <a href="/posts/integrate-lux-inverter-with-home-assistant/">Integrating a Lux Power Inverter with Home Assistant</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/centos/">centos</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/unifi/">unifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/best-practices/">best practices</a> <a class="post-tag btn btn-outline-primary" href="/tags/code-quality/">code quality</a> <a class="post-tag btn btn-outline-primary" href="/tags/home-assistant/">home-assistant</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/configuration/">configuration</a> <a class="post-tag btn btn-outline-primary" href="/tags/container/">container</a></div></section></div><section id="toc-wrapper" class="ps-0 pe-4"><h2 class="panel-heading ps-3 pt-2 mb-2">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/use-google-authenticator-ssh/" class="post-preview card h-100"><div class="card-body"> <time class="small" data-ts="1389139200" data-df="ll" > Jan 8, 2014 </time><h4 class="pt-0 my-2">Use Google Authenticator for 2FA with SSH</h4><div class="text-muted small"><p> By default, SSH uses password authentication, most SSH hardening instructions recommend using SSH keys instead. However, SSH keys still only provide a single factor authentication, even though it i...</p></div></div></a></article><article class="col"> <a href="/posts/mikrotik-openvpn-server-with-linux-client/" class="post-preview card h-100"><div class="card-body"> <time class="small" data-ts="1438124400" data-df="ll" > Jul 29, 2015 </time><h4 class="pt-0 my-2">Mikrotik OpenVPN Server with Linux Client</h4><div class="text-muted small"><p> I spent quite some time trying to get the OpenVPN Server working on the Mikrotik Router with a Linux client, It caused some pain and I didn’t want others to go through that. I have therefore writte...</p></div></div></a></article><article class="col"> <a href="/upgrade-linux-unifi-controller-minutes/" class="post-preview card h-100"><div class="card-body"> <time class="small" data-ts="1488056596" data-df="ll" > Feb 25, 2017 </time><h4 class="pt-0 my-2">Upgrade your Linux UniFi Controller in minutes!</h4><div class="text-muted small"><p> Ubiquiti’s provide a Controller version for other distributions of linux but only display debian on their site, but if you’re running CentOS or another Linux distribution, you’ll have to use the ge...</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/type-hinting-and-checking-in-python/" class="btn btn-outline-primary" aria-label="Older" ><p>Type hinting and checking in Python</p></a> <a href="/posts/homer-dashboard-with-docker/" class="btn btn-outline-primary" aria-label="Newer" ><p>Homer dashboard with Docker</p></a></nav><script type="text/javascript"> (function () { const origin = 'https://giscus.app'; const iframe = 'iframe.giscus-frame'; const lightTheme = 'light'; const darkTheme = 'dark_dimmed'; let initTheme = lightTheme; const html = document.documentElement; if ( (html.hasAttribute('data-mode') && html.getAttribute('data-mode') === 'dark') || (!html.hasAttribute('data-mode') && window.matchMedia('(prefers-color-scheme: dark)').matches) ) { initTheme = darkTheme; } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'totaldebug/totaldebug.uk', 'data-repo-id': 'MDEwOlJlcG9zaXRvcnkzMTkxMTkxNTE=', 'data-category': 'General', 'data-category-id': 'DIC_kwDOEwVfL84CPpH4', 'data-mapping': 'pathname', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'bottom', 'data-lang': 'en', 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusScript = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusScript.setAttribute(key, value) ); document.getElementById('tail-wrapper').appendChild(giscusScript); addEventListener('message', (event) => { if ( event.source === window && event.data && event.data.direction === ModeToggle.ID ) { /* global theme mode changed */ const mode = event.data.message; const theme = mode === ModeToggle.DARK_MODE ? darkTheme : lightTheme; const message = { setConfig: { theme: theme } }; const giscus = document.querySelector(iframe).contentWindow; giscus.postMessage({ giscus: message }, origin); } }); })(); </script><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p> © <time>2024</time> <a href="https://github.com/marksie1988">Steven Marks</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a></p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/centos/">centos</a> <a class="post-tag btn btn-outline-primary" href="/tags/docker/">docker</a> <a class="post-tag btn btn-outline-primary" href="/tags/linux/">linux</a> <a class="post-tag btn btn-outline-primary" href="/tags/unifi/">unifi</a> <a class="post-tag btn btn-outline-primary" href="/tags/best-practices/">best practices</a> <a class="post-tag btn btn-outline-primary" href="/tags/code-quality/">code quality</a> <a class="post-tag btn btn-outline-primary" href="/tags/home-assistant/">home-assistant</a> <a class="post-tag btn btn-outline-primary" href="/tags/automation/">automation</a> <a class="post-tag btn btn-outline-primary" href="/tags/configuration/">configuration</a> <a class="post-tag btn btn-outline-primary" href="/tags/container/">container</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script src="https://cdn.jsdelivr.net/combine/npm/jquery@3.6.1/dist/jquery.min.js,npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js,npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/magnific-popup@1.1.0/dist/jquery.magnific-popup.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.6/dayjs.min.js,npm/dayjs@1.11.6/locale/en.min.js,npm/dayjs@1.11.6/plugin/relativeTime.min.js,npm/dayjs@1.11.6/plugin/localizedFormat.min.js,npm/tocbot@4.20.1/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-ZDGYQV98HT"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-ZDGYQV98HT'); }); </script> <script> /* Note: dependent library will be loaded in `js-selector.html` */ SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{snippet}</p></article>', noResultsText: '<p class="mt-5"></p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
